{% extends "livres/base.html" %}
{% load static %}

{% block title %}{% if action == 'creation' %}Creation{% else %}Modifier {% endif %} livre {% endblock title %}

{% block header %}
    {% include 'livres/common_header.html' %}
{% endblock header %}

{% block content %}
    <legend><h1>{% if action == 'creation' %}Nouveau {% else %}Modifier {% endif %} livre</h1></legend>
    {% if action == 'creation' %}
        <form action="{% url 'livres:subnouvlivre' %}" method="post">
    {% else %}
        <form action="{% url 'livres:subeditlivre' %}" method="post">
    {% endif %}
{% csrf_token %}
<input type="hidden" name="livre_id" value="{{ livre.id }}">

<div class="form-group row">
    <label for="mode_partage" class="col-sm-2 col-form-label">Mode de partage du livre:</label>
    <div class="col-sm-10">
        {% if action == 'creation' or livre.createur == user %}
            <select class="form-control" id="mode_partage" name="mode_partage">
                <option value="DON" {% if action != 'creation' and livre.mode_partage == 'DON' %}selected {% endif %}>
                    Don
                </option>
                <option value="PRET" {% if action != 'creation' and livre.mode_partage == 'PRET' %}selected {% endif %}>
                    Prêt
                </option>
            </select>
        {% else %}
{#Seul le createur d'un livre peut modifier son mode de partage. TODO: a rafiner si le livre a été donné initialement...#}
            <input type="text" readonly class="form-control-plaintext" id="codecouverture"
                   value="{{ livre.mode_partage }}">
        {% endif %}

    </div>
</div>

<div class="form-group row">
    <label for="titre" class="col-sm-2 col-form-label">Titre:</label>
    <div class="col-sm-10">
        <input type="text" class="form-control" id="titre" name="titre" value="{{ livre.titre_text }}" required>
    </div>
</div>
<div class="form-group row">
    <label for="auteur" class="col-sm-2 col-form-label">Auteur(s):</label>
    <div class="col-sm-10">
        <input type="text" class="form-control" id="auteur" name="auteur" value="{{ livre.auteur_text }}">
    </div>
</div>

{% if action != 'creation' %}
    <div class="form-group row">
        <label for="codecouverture" class="col-sm-2 col-form-label">Code de couverture:</label>
        <div class="col-sm-10">
            <input type="text" readonly class="form-control-plaintext" id="codecouverture"
                   value="{{ livre.livre_code }}">
        </div>
    </div>
{% endif %}

<div class="form-group row">
    <label for="dateEditionInput" class="col-sm-2 col-form-label">Date de publication:</label>
    <div class="col-sm-10">
        <input type="text" class="form-control" id="dateEditionInput" name="dateEditionInput"
               value='{{ livre.publication_date|date:"d M Y"|default_if_none:"" }}' placeholder="jj/mm/yyyy">
    </div>
</div>

<div class="form-group row">
    <label for="pageweb" class="col-sm-2 col-form-label">Page web d'info:</label>
    <div class="col-sm-10">
        <input type="text" class="form-control" id="pageweb" name="pageweb"
               value="{{ livre.url_externe_livre_text }}" placeholder="https://.....">
    </div>
</div>

<div class="form-group row">
    <label for="motssujets" class="col-sm-2 col-form-label">3 mots sujets:</label>
    <div class="col-sm-10">
        <input type="text" class="form-control" id="motssujets" name="motssujets"
               value="{{ livre.mots_sujets_txt }}" placeholder="3 mots pour compléter la description de ce livre.">
    </div>
</div>


<div class="form-group row">
    <div class="col-sm-10">
        {% if action == 'creation' %}
            <button type="submit" class="btn btn-primary">Enregistrer nouveau Livre</button>
        {%  else %}
            <button type="submit" class="btn btn-primary">Enregistrer modifications Livre</button>
        {% endif %}
    </div>
</div>

</form>

{% endblock content %}

{% block footer_scripts %}{% endblock %}